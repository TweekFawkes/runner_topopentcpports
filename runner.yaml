runner:
  name: Top Open TCP Ports
  description: TCP port scans a target and return a list of open TCP ports. Trys TCP Ports 0 thru 65535 (-p 0-65535 -ep 25 -csv -sa).
  version: 0.0.1

build:
  commands: |
    echo "START: Building the runner"
    apt install -y build-essential
    apt install -y libpcap-dev
    wget https://go.dev/dl/go1.21.6.linux-amd64.tar.gz && tar -C /usr/local -xzf go1.21.6.linux-amd64.tar.gz && rm go1.21.6.linux-amd64.tar.gz
    ENV GOROOT=/usr/local/go
    ENV GOPATH=/go
    ENV PATH=$GOPATH/bin:$GOROOT/bin:$PATH
    ENV CGO_ENABLED=1
    mkdir -p /go/src
    mkdir -p /go/bin
    go install -v github.com/projectdiscovery/naabu/v2/cmd/naabu@latest
    echo "END: Building the runner"

webform:
  - name: host_to_scan
    prompt: Host
    type: text

launch:
  type: binary
  command: /go/bin/naabu -p 80,443,22,21,23,25,161,8080,8081,8082,8083,8443,8888,10000,4567,3389,110,3306,5432,5900,1723,587,993,995,7547,5555 -ep 25 -sa -csv -o outputs/scan_output.csv -host ${host_to_scan}